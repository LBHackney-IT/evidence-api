# 6. Use Palos Altos to perform malware scanning

Date: 2021-05-27

## Status

Accepted

## Context

Our service allows members of the public to upload files which are viewed, and potentially downloaded, by council officers. There is a possibility that the files could contain malware or other malicious code, so we should scan all uploaded files before making them available to officers

We also evaluated other approaches including Trend Micro Cloud One, and building a bespoke solution with ClamAV

## Decision

Leverage HackIT infrastructure which uses Palo Altos to inspect all network traffic.

A diagram can be found on [Miro](https://miro.com/app/board/o9J_kgEWTBE=/) but at a high level we:
1. Attempt to download the file uploaded by the resident. This will be routed via the Palo Altos network for malware scanning
2. Trigger processing based on the download status
    - If the download is not terminated then the file is clean and can be viewable by officers
    - If the download is terminated then the file contains malware

## Consequences

This approach has some drawbacks:
- We do not receive a notification from Palo Altos when the file does _not_ contain malware. If Palos Alto were to have issues and is not able to correctly scan for malware then downloads will not be blocked and we assume the files do not contain malware

It also has a number of benefits:
- By using existing infrastructure we do not need to engage with a new vendor to perform the malware scanning
- Files are stored in separate directories based on their status so it is clear which have gone through the scanning process
